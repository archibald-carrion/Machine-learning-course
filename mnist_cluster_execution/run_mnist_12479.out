=== Variables de entorno ===
NVHPC_ROOT: /opt/nvidia/hpc_sdk/Linux_x86_64/24.5
CUDA_HOME: /opt/nvidia/hpc_sdk/Linux_x86_64/24.5/cuda/12.4
LD_LIBRARY_PATH: /opt/nvidia/hpc_sdk/Linux_x86_64/24.5/cuda/12.4/targets/x86_64-linux/lib:/usr/local/cuda-12.5/lib64:/opt/ohpc/pub/mpi/libfabric/1.13.0/lib:/opt/ohpc/pub/mpi/ucx-ohpc/1.14.1/lib:/opt/ohpc/pub/libs/hwloc/lib:/opt/ohpc/pub/mpi/openmpi4-gnu12/4.1.5/lib:/opt/ohpc/pub/compiler/gcc/12.2.0/lib64

=== Verificando CUDA con Python ===
Python version: 3.12.11 (main, Jun  4 2025, 17:36:43) [Clang 20.1.4 ]
CUDA_HOME: /opt/nvidia/hpc_sdk/Linux_x86_64/24.5/cuda/12.4
LD_LIBRARY_PATH: /opt/nvidia/hpc_sdk/Linux_x86_64/24.5/cuda/12.4/targets/x86_64-linux/lib:/usr/local/cuda-12.5/lib64:/opt/ohpc/pub/mpi/libfabric/1.13.0/lib:/opt/ohpc/pub/mpi/ucx-ohpc/1.14.1/lib:/opt/ohpc/pub/libs/hwloc/lib:/opt/ohpc/pub/mpi/openmpi4-gnu12/4.1.5/lib:/opt/ohpc/pub/compiler/gcc/12.2.0/lib64

PyTorch info:
PyTorch version: 2.7.1+cu126
CUDA available: True
CUDA version: 12.6
GPU count: 1
GPU name: NVIDIA A100-SXM4-80GB

Error importing CuPy: No module named 'cupy' 

Using device: cuda
Random seed set to 42

==================================================
LOADING DATA
==================================================
Loading MNIST data from mnist_data.csv...
Data loaded: 70000 samples with 784 features
Training: 50400, Validation: 5600, Test: 14000

==================================================
INITIALIZING MODEL
==================================================
CNN Model initialized
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
├─Conv2d: 1-1                            320
├─ReLU: 1-2                              --
├─MaxPool2d: 1-3                         --
├─Conv2d: 1-4                            18,496
├─ReLU: 1-5                              --
├─MaxPool2d: 1-6                         --
├─Flatten: 1-7                           --
├─Linear: 1-8                            401,536
├─ReLU: 1-9                              --
├─Linear: 1-10                           1,290
├─Softmax: 1-11                          --
=================================================================
Total params: 421,642
Trainable params: 421,642
Non-trainable params: 0
=================================================================

==================================================
TRAINING MODEL
==================================================
Training model with 50400 samples for 35 epochs
Each epoch has 788 batches of size 64
Validating with 5600 samples
Epoch 5/35 - Loss: 1.4740, Acc: 0.9878, Val Loss: 1.4762, Val Acc: 0.9848
Epoch 10/35 - Loss: 1.4687, Acc: 0.9925, Val Loss: 1.4750, Val Acc: 0.9864
Epoch 15/35 - Loss: 1.4665, Acc: 0.9948, Val Loss: 1.4729, Val Acc: 0.9880
Epoch 20/35 - Loss: 1.4661, Acc: 0.9951, Val Loss: 1.4722, Val Acc: 0.9889
Epoch 25/35 - Loss: 1.4650, Acc: 0.9963, Val Loss: 1.4727, Val Acc: 0.9880
Epoch 30/35 - Loss: 1.4641, Acc: 0.9971, Val Loss: 1.4765, Val Acc: 0.9850
Epoch 35/35 - Loss: 1.4643, Acc: 0.9969, Val Loss: 1.4725, Val Acc: 0.9886

==================================================
EVALUATING MODEL
==================================================
Evaluating model on 14000 test samples

Test Accuracy: 0.9906

Classification Report:
              precision    recall  f1-score   support

           0       0.98      1.00      0.99      1381
           1       0.99      0.99      0.99      1575
           2       0.99      0.98      0.99      1398
           3       0.99      0.99      0.99      1428
           4       0.99      0.99      0.99      1365
           5       0.99      0.99      0.99      1263
           6       0.99      0.99      0.99      1375
           7       0.99      0.99      0.99      1459
           8       0.99      0.99      0.99      1365
           9       0.99      0.99      0.99      1391

    accuracy                           0.99     14000
   macro avg       0.99      0.99      0.99     14000
weighted avg       0.99      0.99      0.99     14000


Confusion Matrix:
[[1378    1    0    0    0    0    1    0    1    0]
 [   0 1564    1    1    1    1    1    6    0    0]
 [   5    1 1377    1    4    0    3    5    1    1]
 [   2    1    2 1415    0    3    0    3    1    1]
 [   1    1    0    0 1349    0    3    1    2    8]
 [   3    0    0    2    0 1252    4    0    1    1]
 [   7    2    0    0    2    0 1364    0    0    0]
 [   1    2    3    1    2    0    0 1445    0    5]
 [   2    1    1    3    0    1    4    0 1349    4]
 [   2    1    0    0    4    2    1    4    1 1376]]

==================================================
PLOTTING RESULTS
==================================================
Plotting training history for 35 epochs
Training history plot saved as 'training_history.png'

==================================================
ALL DONE!
==================================================
